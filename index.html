<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PRO GAMBLER</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: white;
      margin: 0;
      padding: 20px;
      transition: background 0.3s, color 0.3s;
    }
    .light-mode {
      background-color: #f4f4f4;
      color: black;
    }
    .container {
      max-width: 400px;
      margin: auto;
    }
    .row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 8px 0;
    }
    label {
      flex: 1;
      font-size: 14px;
      font-weight: bold;
    }
    input {
      flex: 1;
      padding: 4px;
      margin-left: 6px;
      font-size: 14px;
      text-align: right;
    }
    .small-input {
      width: 60px;
      text-align: center;
    }
    button {
      padding: 6px 12px;
      margin: 2px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
    .toggle {
      position: absolute;
      right: 20px;
      top: 20px;
      cursor: pointer;
    }
    .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: inherit;
      min-width: 200px;
      max-height: 150px;
      overflow-y: auto;
      padding: 6px;
      border: 1px solid gray;
      border-radius: 8px;
    }
    .dropdown.show .dropdown-content {
      display: block;
    }
    .bubble {
      display: inline-block;
      background: #2196F3;
      color: white;
      padding: 6px 10px;
      margin: 4px;
      border-radius: 50%;
      font-size: 12px;
    }
    .quote-box {
      margin-top: 10px;
      font-style: italic;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="toggle">
    <button onclick="toggleMode()">ðŸŒ™</button>
  </div>

  <div class="container">
    <div class="row"><label>IB</label><input type="number" id="ib" value="10000"></div>
    <div class="row"><label>CB</label>
      <input type="number" id="cb" value="10000" class="small-input">
      <input type="number" id="cbChange" placeholder="+/-" class="small-input">
      <button onclick="changeCB('+')">+</button>
      <button onclick="changeCB('-')">-</button>
    </div>
    <div class="row"><label>TDD</label><input type="number" id="tdd" value="2000"></div>
    <div class="row"><label>RISK</label><input type="number" id="risk" value="100"></div>

    <div class="row">
      <button onclick="recordWin()">WIN</button>
      <button onclick="recordLoss()">LOSS</button>
      <button onclick="undo()">UNDO</button>
    </div>

    <div class="row"><label>WINRATE</label><span id="winrate">0%</span></div>
    <div class="row"><label>NEXT RISK</label><span id="nextRisk">0</span></div>

    <div class="dropdown">
      <button onclick="toggleDropdown()">EVENTS</button>
      <div class="dropdown-content" id="eventLog"></div>
    </div>

    <div class="quote-box" id="quoteBox"></div>
  </div>

<script>
  let wins = 0, losses = 0, history = [];
  const quotes = [
    "Losses are just the cost of doing business.",
    "Stick to the process, not the outcome.",
    "Trading is a marathon, not a sprint.",
    "Every loss brings you closer to discipline.",
    "The edge plays out over time, not today."
  ];

  function toggleMode() {
    document.body.classList.toggle("light-mode");
  }

  function changeCB(type) {
    let cb = parseFloat(document.getElementById("cb").value);
    let change = parseFloat(document.getElementById("cbChange").value) || 0;
    if (type === '+') cb += change;
    else cb -= change;
    document.getElementById("cb").value = cb;
    updateRisk();
  }

  function recordWin() {
    wins++;
    history.push("WIN");
    addBubble("W");
    showQuote();
    updateStats();
  }

  function recordLoss() {
    losses++;
    history.push("LOSS");
    addBubble("L");
    showQuote();
    updateStats();
  }

  function undo() {
    let last = history.pop();
    if (last === "WIN") wins--;
    if (last === "LOSS") losses--;
    updateStats();
    renderEvents();
  }

  function updateStats() {
    let total = wins + losses;
    let winrate = total > 0 ? ((wins / total) * 100).toFixed(1) : 0;
    document.getElementById("winrate").textContent = winrate + "%";
    updateRisk();
    renderEvents();
  }

  function updateRisk() {
    let cb = parseFloat(document.getElementById("cb").value);
    let tdd = parseFloat(document.getElementById("tdd").value);
    let risk = parseFloat(document.getElementById("risk").value);
    let remainingDD = tdd - (parseFloat(document.getElementById("ib").value) - cb);
    let nextRisk = (remainingDD / tdd) * risk;
    document.getElementById("nextRisk").textContent = nextRisk.toFixed(2);
  }

  function addBubble(text) {
    const bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.textContent = text;
    document.getElementById("eventLog").appendChild(bubble);
  }

  function renderEvents() {
    let eventLog = document.getElementById("eventLog");
    eventLog.innerHTML = "";
    history.forEach(h => {
      const bubble = document.createElement("div");
      bubble.className = "bubble";
      bubble.textContent = h === "WIN" ? "W" : "L";
      eventLog.appendChild(bubble);
    });
  }

  function toggleDropdown() {
    document.querySelector(".dropdown").classList.toggle("show");
  }

  function showQuote() {
    let quote = quotes[Math.floor(Math.random() * quotes.length)];
    document.getElementById("quoteBox").textContent = quote;
  }

  updateRisk();
</script>
</body>
</html>
